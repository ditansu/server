#!groovy

stage("Prepare") {

    node('master') {

        echo "Start prepare..."
        def WORK_NODE = ''


        if (BRANCH_NAME == 'devops_develop') {
            WORK_NODE = 'chstage-node'
        } else if (BRANCH_NAME == 'devops_prod') {
            WORK_NODE = 'chstage-node'
        }
        echo "end prepare the Node is ${WORK_NODE}..."
        sh 'printenv'
    }
}

stage("1 of 3 Checkout") {

    node(env.WORK_NODE){

        WORK_DIR = pwd() //"${BASE_DIR}/${WS_DIR}"
        SCRIPTS_DIR = "${WORK_DIR}/Devops"

        //MySQL config
        MYSQL_CONFIG = "/home/jenkins/ch-stage/scripts/mysql.json"
        SERVER_CONFIG_DIR = "${WORK_DIR}/Config/secrets/"

        //Build config
        VAPOR = "/usr/local/bin/vapor"
        BUILD_PARAM = "--verbose --release"

        echo "Start checkout on node: ${env.WORK_NODE}..."
        checkout scm
        echo "========================"
        sh 'printenv'
        echo "========================"

    }

}

    //println BRANCH_NAME //"Branch ${env.BRANCH_NAME}"

/*
    if (env.GIT_BRANCH.consits("develop")){
        WORK_NODE = "chstage-node"
    } else {
        WORK_NODE = "chprod-node"
    }
*/
    //println "Work node is ${WORK_NODE}"
